<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="Interactive crime visualization dashboard for Charlotte, NC" name="description"/>
    <title>Crime Lens of Charlotte</title>
    <link
            crossorigin=""
            href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            rel="stylesheet"
    />
    <script
            crossorigin=""
            defer
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    ></script>
    <script defer src="https://d3js.org/d3.v7.min.js"></script>
    <link href="favicon/favicon.ico" rel="icon" sizes="any"/>
    <link href="css/styles.css" rel="stylesheet"/>
    <style>
        #mapVisualization {
            min-height: 480px;
        }
    </style>
</head>
<body>
<header class="dash-header">
    <div class="container">
        <a class="brand" href="/">
            <img alt="Crime Lens of Charlotte" height="150" src="favicon/crime-lens-charlotte.svg" width="150"/>
        </a>
        <h1 class="dashboard-title">Crime Lens of Charlotte</h1>
        <p class="dashboard-subtitle">Exploring Crime in Charlotte</p>
    </div>
</header>
<main class="dashboard-main">
    <div class="container">
        <!-- Tab Nav -->
        <div class="tabs-nav">
            <button class="tab-btn active" data-tab="crimeMap">Crime Map</button>
            <button class="tab-btn" data-tab="temporal">Temporal Crime</button>
            <button class="tab-btn" data-tab="metrics">Metrics</button>
        </div>
        <!-- Crime Map -->
        <div id="crimeMapTab" class="tab-content active">
            <!-- Filter -->
            <section class="control-panel">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h2 class="section-title" style="margin: 0;">Filters & Controls</h2>
                <div id="totalCount" style="font-size: 1.1rem; font-weight: 600; color: #24B24A;">
                    Total Incidents: <span id="incidentCount">0</span>
                </div>
            </div>
            <div class="control-grid">
                <div class="control-group span-4">
                    <label for="startDate">Date Range</label>
                    <div class="date-inputs">
                        <input id="startDate" name="startDate" type="date"/>
                        <span class="date-separator">to</span>
                        <input id="endDate" name="endDate" type="date"/>
                    </div>
                </div>
                <div class="control-group span-3">
                    <label for="zipCode">ZIP Code</label>
                    <span class="helper-text">Filter by location</span>
                    <select id="zipCode" name="zipCode">
                        <option selected value="all">All ZIP Codes</option>
                    </select>
                </div>
                <div class="control-group span-4">
                    <label for="crimeType">Crime Type</label>
                    <span class="helper-text">Select one or Ctrl+Click for multiple</span>
                    <select id="crimeType" multiple name="crimeType" size="9">
                        <option selected value="all">All Crime Types</option>
                        <option value="violent">Violent Crimes</option>
                        <option value="sex">Sex Crimes</option>
                        <option value="property">Property Crimes</option>
                        <option value="fraud">Fraud / Financial Crimes</option>
                        <option value="drug">Drug & Alcohol Offenses</option>
                        <option value="publicOrder">Public Order Crimes</option>
                        <option value="weapons">Weapons Offenses</option>
                        <option value="other">Special / Other Incidents</option>
                    </select>
                </div>
                <div class="control-group span-1 align-end">
                    <button class="btn-reset" id="resetFilters" type="button">Reset</button>
                </div>
            </div>
        </section>
        <!-- Visuals -->
        <div class="visualization-grid">
            <section class="viz-panel viz-panel-full">
                <h2 class="panel-title">Incident Crime Map</h2>
                <div class="map-container">
                    <!-- Crime Type Legend (Left Side) -->
                    <div class="crime-type-legend" id="crimeTypeGrid"></div>
                    <!-- Map -->
                    <div id="mapVisualization"></div>
                    <!-- Modal for Crime Details -->
                    <div id="crimeModal" class="crime-modal">
                        <div class="crime-modal-content">
                            <span class="modal-close">&times;</span>
                            <h3 id="modalCrimeTitle" class="crime-modal-title"></h3>
                            <ul id="modalCrimeList" class="crime-modal-list"></ul>
                        </div>
                    </div>
                </div>
                <div class="map-legend" id="mapLegend"></div>
            </section>
        </div>
        </div>
        <!-- TEMPORAL CRIME TAB -->
        <div id="temporalTab" class="tab-content">
           <section class="metric-section">
                <div class="metric-viz-container" id="temporalContainer">
                </div>
            </section>
        </div>
        <!-- Metrics -->
        <div id="metricsTab" class="tab-content">
            <h2 class="metrics-header">Crime Metrics & Insights</h2>
            <p class="metrics-intro">Explore detailed crime statistics and answer key questions about crime patterns in Charlotte.</p>
            <!-- Crime Type Distribution -->
            <section class="metric-section">
                <div class="metric-header">
                    <h3 class="metric-title">Crime Hotspots</h3>
                </div>
                <div class="metric-viz-container" id="metricCrimeTypes">
                </div>
            </section>
            <!-- Top Crime Hotspots by ZIP Code -->
            <section class="metric-section">
                <div class="metric-header">
                    <h3 class="metric-title">Top Crime Hotspots by ZIP Code</h3>
                </div>
                <div class="metric-viz-container">
                    <svg id="zipHotspots" style="width:100%; height:750px; display:block;"></svg>
                </div>
            </section>
        </div>
    </div>
</main>
<!-- Tooltips -->
<div aria-hidden="true" class="tooltip" id="tooltip" role="tooltip"></div>
<div class="loading-overlay hidden" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading crime data...</p>
</div>
<script src="js/main.js" type="module"></script>
</body>
</html>