<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="Interactive crime visualization dashboard for Charlotte, NC" name="description"/>
    <title>Crime Lens of Charlotte</title>

    <!-- Leaflet (hosted with SRI & CORS) -->
    <link
            crossorigin=""
            href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            rel="stylesheet"
    />
    <script
            crossorigin=""
            defer
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    ></script>

    <!-- D3 -->
    <script defer src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Favicon + Styles -->
    <link href="favicon/favicon.ico" rel="icon" sizes="any"/>
    <link href="styles.css" rel="stylesheet"/>

    <!-- Optional: fallback height if your CSS doesn't set one -->
    <style>
        #mapVisualization {
            min-height: 480px;
        }
    </style>
</head>
<body>
<header class="dash-header">
    <div class="container">
        <a class="brand" href="/">
            <img alt="Crime Lens of Charlotte" height="150" src="favicon/crime-lens-charlotte.svg" width="150"/>
        </a>
        <h1 class="dashboard-title">Crime Lens of Charlotte</h1>
        <p class="dashboard-subtitle">Exploring Crime in Charlotte</p>
    </div>
</header>

<main class="dashboard-main">
    <div class="container">
        <!-- FILTER PANEL -->
        <section class="control-panel">
            <h2 class="section-title">Filters & Controls</h2>
            <div class="control-grid">
                <div class="control-group span-5">
                    <label for="startDate">Date Range</label>
                    <div class="date-inputs">
                        <input id="startDate" name="startDate" type="date"/>
                        <span class="date-separator">to</span>
                        <input id="endDate" name="endDate" type="date"/>
                    </div>
                </div>
                <div class="control-group span-4">
                    <label for="crimeType">Crime Type</label>
                    <span class="helper-text">Select one or Ctrl+Click for multiple</span>
                    <select id="crimeType" multiple name="crimeType" size="6">
                        <option selected value="all">All Crime Types</option>
                        <option value="violent">Violent Crimes</option>
                        <option value="sex">Sex Crimes</option>
                        <option value="property">Property Crimes</option>
                        <option value="fraud">Fraud / Financial Crimes</option>
                        <option value="drug">Drug & Alcohol Offenses</option>
                        <option value="publicOrder">Public Order Crimes</option>
                        <option value="weapons">Weapons Offenses</option>
                        <option value="other">Special / Other Incidents</option>
                    </select>
                </div>
                <div class="control-group span-2">
                    <label for="zipCode">ZIP Code</label>
                    <select id="zipCode" name="zipCode">
                        <option selected value="all">All ZIP Codes</option>
                    </select>
                </div>
                <div class="control-group span-1 align-end">
                    <button class="btn-reset" id="resetFilters" type="button">Reset</button>
                </div>
            </div>
        </section>

        <!-- CRIME CATEGORY REFERENCE -->
        <section class="card" id="crimeTypeGuide">
            <div class="card-header">
                <h2 class="card-title">Whatâ€™s in each crime type?</h2>
                <p class="card-subtitle">These groups follow NIBRS-style categories used by CMPD.</p>
            </div>
            <div class="ct-grid" id="crimeTypeGrid"></div>
        </section>

        <!-- VISUALIZATIONS -->
        <div class="visualization-grid">
            <section class="viz-panel viz-panel-large">
                <h2 class="panel-title">Incident Crime Map</h2>
                <div id="mapVisualization"></div>
                <div class="map-legend" id="mapLegend"></div>
            </section>

            <section class="viz-panel viz-panel-large">
                <h2 class="panel-title">Homicides by Patrol Division & Weapon Type</h2>
                <div id="homicidesTreemap"></div>
            </section>

            <section class="viz-panel viz-panel-large">
                <h2 class="panel-title">Violent Crimes Over Time by Type</h2>
                <div id="violentStackedArea" style="width:100%; height:600px;"></div>
            </section>

            <section class="viz-panel">
                <h2 class="panel-title">Crime Trends Over Time</h2>
                <svg id="trendVisualization" style="width:100%; height:400px; display:block;"></svg>
            </section>

            <section class="viz-panel">
                <h2 class="panel-title">Crime Type Distribution</h2>
                <svg id="distributionVisualization" style="width:100%; height:500px; display:block;"></svg>
            </section>
        </div>
    </div>
</main>

<!-- Tooltip + Loader -->
<div aria-hidden="true" class="tooltip" id="tooltip" role="tooltip"></div>
<div class="loading-overlay hidden" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading crime data...</p>
</div>

<!-- MAIN SCRIPT (loads after Leaflet/D3 because of defer) -->
<script defer src="visualization.js"></script>
</body>
</html>